<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Q-TRACK - Système de Management de la Qualité par RIAHI">
    <meta name="author" content="RIAHI">
    <meta name="keywords" content="qualité, management, iso 9001, dmaic, pdca, q-track">
    <meta name="robots" content="index, follow">

    <title>Q-TRACK by RIAHI - Management de la Qualité</title>

    <!-- Versioning pour traçabilité (ISO 9001) -->
    <meta name="app-version" content="1.0.0">

    <!-- CDN Optimisés (Lean - Performance) -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">

    <script src="https://cdn.jsdelivr.net/npm/react@18.0.0/umd/react.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.0.0/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Favicon pour accessibilité (ISO 9241) -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>Q</text></svg>">

    <style>
        /* Variables CSS pour standardisation (Lean) */
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #1e40af;
            --accent-color: #60a5fa;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --background: #f9fafb;
            --card-bg: #ffffff;
            --border-color: #e5e7eb;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --success-color: #10b981;
            --info-color: #3b82f6;
        }

        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
            background-color: var(--background);
            color: var(--text-primary);
        }

        /* Animation optimisée (Performance) */
        .sidebar-transition {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade {
            animation: fadeIn 0.5s ease-out forwards;
        }

        /* Accessibilité (ISO 9241) */
        .focus-visible:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* Performance - Chargement différé */
        .lazy-load {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .lazy-load.loaded {
            opacity: 1;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-900">
    <!-- Indicateur de chargement pour UX (Lean - Qualité perçue) -->
    <div id="loading-indicator" class="fixed top-0 left-0 w-full h-full bg-white z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4">
            </div>
            <p class="text-gray-600">Chargement de Q-TRACK...</p>
        </div>
    </div>

    <div id="root"></div>

    <!-- Service Worker pour PWA (ISO 9001 - Disponibilité) -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registered:', registration);
                    })
                    .catch(error => {
                        console.error('Service Worker registration failed:', error);
                    });
            });
        }
    </script>

    <script type="text/babel">
        // Gestion des erreurs globales (ISO 9001 - Contrôle de la qualité)
        window.addEventListener('error', function (event) {
            console.error('Global error:', event.error);
            // Ici, vous pourriez envoyer les erreurs à un système de monitoring
        });

        // Gestion des promesses rejetées (ISO 9001 - Contrôle de la qualité)
        window.addEventListener('unhandledrejection', function (event) {
            console.error('Unhandled rejection:', event.reason);
            // Ici, vous pourriez envoyer les erreurs à un système de monitoring
        });

        const {useState, useEffect, useMemo, useCallback} = React;

        // Configuration centralisée (Lean - Standardisation)
        const CONFIG = {
            APP_NAME: "Q-TRACK",
            APP_VERSION: "1.0.0",
            DEFAULT_LANG: "fr",
            SUPPORTED_LANGS: ["fr", "en"],
            API_ENDPOINTS: {
                LOGIN: "/api/auth/login",
                REGISTER: "/api/auth/register",
                NON_CONFORMITES: "/api/nc",
                USERS: "/api/users"
            },
            PERFORMANCE_METRICS: {
                MAX_RESPONSE_TIME: 2000, // 2 secondes
                MAX_LOAD_TIME: 3000 // 3 secondes
            }
        };

        // Système de logging structuré (ISO 9001 - Traçabilité)
        class Logger {
            static log(level, message, data = {}) {
                const logEntry = {
                    timestamp: new Date().toISOString(),
                    level,
                    message,
                    data,
                    appVersion: CONFIG.APP_VERSION,
                    userAgent: navigator.userAgent
                };

                console[level === 'error' ? 'error' : 'log'](JSON.stringify(logEntry));

                // Envoyer les logs à un système de monitoring
                if (level === 'error') {
                    this.sendToMonitoring(logEntry);
                }
            }

            static sendToMonitoring(logEntry) {
                // Implémenter l'envoi vers un système de monitoring (Sentry, LogRocket, etc.)
                console.log('Sending to monitoring:', logEntry);
            }

            static info(message, data) {this.log('info', message, data);}
            static warn(message, data) {this.log('warn', message, data);}
            static error(message, data) {this.log('error', message, data);}
        }

        // Système de traduction avec validation (ISO 9001 - Qualité)
        const translations = {
            fr: {
                welcome: "Bienvenue sur Q-TRACK",
                tagline: "Le futur du Management de la Qualité par RIAHI",
                login: "Connexion",
                register: "S'inscrire",
                email: "Email professionnel",
                password: "Mot de passe",
                no_account: "Pas encore de compte ?",
                have_account: "Déjà un compte ?",
                dashboard: "Tableau de Bord",
                nc_operations: "Opérations Qualité",
                analysis: "Analyse & Pilotage (DMAIC)",
                reports: "Rapports & Audit",
                settings: "Paramètres",
                logout: "Déconnexion",
                new_nc: "Nouvelle NC",
                critical_alert: "ALERTE CRITIQUE",
                email_sent: "Un email de notification a été envoyé au responsable.",
                loading: "Chargement...",
                error: "Erreur",
                network_error: "Erreur de réseau. Veuillez réessayer.",
                validation_error: "Veuillez remplir tous les champs correctement."
            },
            en: {
                welcome: "Welcome to Q-TRACK",
                tagline: "The Future of Quality Management by RIAHI",
                login: "Login",
                register: "Register",
                email: "Professional Email",
                password: "Password",
                no_account: "Don't have an account?",
                have_account: "Already have an account?",
                dashboard: "Dashboard",
                nc_operations: "Quality Operations",
                analysis: "Analysis & Control (DMAIC)",
                reports: "Reports & Audit",
                settings: "Settings",
                logout: "Logout",
                new_nc: "New NC",
                critical_alert: "CRITICAL ALERT",
                email_sent: "A notification email has been sent to the manager.",
                loading: "Loading...",
                error: "Error",
                network_error: "Network error. Please try again.",
                validation_error: "Please fill in all fields correctly."
            }
        };

        // Validation des données (ISO 9001 - Contrôle de la qualité)
        class Validator {
            static validateEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

            static validatePassword(password) {
                return password.length >= 8;
            }

            static validateForm(formData) {
                const errors = {};

                if (!formData.email || !this.validateEmail(formData.email)) {
                    errors.email = translations[CONFIG.DEFAULT_LANG].validation_error;
                }

                if (!formData.password || !this.validatePassword(formData.password)) {
                    errors.password = translations[CONFIG.DEFAULT_LANG].validation_error;
                }

                return {
                    isValid: Object.keys(errors).length === 0,
                    errors
                };
            }
        }

        // Composant de chargement (Reutilisable - Lean)
        const LoadingSpinner = ({size = "md"}) => {
            const sizeClasses = {
                sm: "w-4 h-4",
                md: "w-8 h-8",
                lg: "w-12 h-12"
            };

            return (
                <div className={`${sizeClasses[size]} border-4 border-blue-600 border-t-transparent rounded-full animate-spin`}></div>
            );
        };

        // Composant de notification (Reutilisable - Lean)
        const Notification = ({type, message, onClose}) => {
            const typeClasses = {
                success: "bg-green-100 border-green-400 text-green-700",
                error: "bg-red-100 border-red-400 text-red-700",
                warning: "bg-yellow-100 border-yellow-400 text-yellow-700",
                info: "bg-blue-100 border-blue-400 text-blue-700"
            };

            const iconClasses = {
                success: "fas fa-check-circle",
                error: "fas fa-exclamation-circle",
                warning: "fas fa-exclamation-triangle",
                info: "fas fa-info-circle"
            };

            return (
                <div className={`fixed top-4 right-4 p-4 rounded-lg shadow-lg border ${typeClasses[type]} max-w-sm z-50 animate-fade`}>
                    <div className="flex items-center justify-between">
                        <div className="flex items-center">
                            <i className={`${iconClasses[type]} mr-3`}></i>
                            <span>{message}</span>
                        </div>
                        <button onClick={onClose} className="ml-4 text-gray-500 hover:text-gray-700">
                            <i className="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            );
        };

        // Composant de statistique (Reutilisable - Lean)
        const StatCard = ({icon, title, value, subtitle, color = "blue"}) => {
            const colorClasses = {
                blue: "bg-blue-50 text-blue-600",
                green: "bg-green-50 text-green-600",
                yellow: "bg-yellow-50 text-yellow-600",
                red: "bg-red-50 text-red-600"
            };

            return (
                <div className="bg-white p-6 rounded-3xl shadow-sm border border-slate-100">
                    <div className="flex items-center justify-between mb-4">
                        <div className={`p-3 ${colorClasses[color]} rounded-2xl`}>
                            <i className={`${icon} text-xl`}></i>
                        </div>
                        <span className="text-xs font-bold text-slate-400 uppercase tracking-wider">Total</span>
                    </div>
                    <h3 className="text-3xl font-black text-slate-900">{value}</h3>
                    <p className="text-sm text-slate-500 mt-1">{subtitle}</p>
                </div>
            );
        };

        const LandingPage = ({onLogin, onRegister, t, isLoading}) => {
            // Mesure de la performance (DMAIC - Measure)
            useEffect(() => {
                const startTime = performance.now();

                return () => {
                    const loadTime = performance.now() - startTime;
                    Logger.info("Landing page loaded", {loadTime});

                    if (loadTime > CONFIG.PERFORMANCE_METRICS.MAX_LOAD_TIME) {
                        Logger.warn("Landing page load time exceeded threshold", {loadTime});
                    }
                };
            }, []);

            return (
                <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 text-white p-6">
                    <div className="max-w-4xl text-center space-y-8 animate-fade">
                        <div className="inline-block p-3 rounded-2xl bg-blue-500/20 border border-blue-400/30 mb-4">
                            <i className="fas fa-shield-halved text-4xl text-blue-400"></i>
                        </div>
                        <h1 className="text-6xl font-black tracking-tighter mb-4">Q-TRACK <span className="text-blue-400">by RIAHI</span></h1>
                        <p className="text-xl text-slate-300 max-w-2xl mx-auto">{t.tagline}</p>
                        <div className="flex flex-wrap justify-center gap-4 pt-8">
                            <button
                                onClick={onLogin}
                                disabled={isLoading}
                                className="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-xl font-bold text-lg transition-all transform hover:scale-105 shadow-xl shadow-blue-500/20 disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                {isLoading ? <LoadingSpinner size="sm" /> : t.login}
                            </button>
                            <button
                                onClick={onRegister}
                                disabled={isLoading}
                                className="px-8 py-4 bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl font-bold text-lg transition-all backdrop-blur-sm disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                {isLoading ? <LoadingSpinner size="sm" /> : t.register}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const AuthForm = ({type, onSubmit, onToggle, t, isLoading}) => {
            const [formData, setFormData] = useState({
                email: '',
                password: ''
            });
            const [errors, setErrors] = useState({});

            const handleSubmit = useCallback(async (e) => {
                e.preventDefault();

                // Validation des données (ISO 9001 - Contrôle de la qualité)
                const validation = Validator.validateForm(formData);

                if (!validation.isValid) {
                    setErrors(validation.errors);
                    Logger.warn("Form validation failed", validation.errors);
                    return;
                }

                try {
                    setErrors({});
                    await onSubmit(formData);
                } catch (error) {
                    setErrors({general: t.network_error});
                    Logger.error("Auth form submission failed", error);
                }
            }, [formData, onSubmit, t]);

            const handleChange = (field) => (e) => {
                setFormData(prev => ({...prev, [field]: e.target.value}));
                // Effacer les erreurs quand l'utilisateur corrige
                if (errors[field]) {
                    setErrors(prev => ({...prev, [field]: undefined}));
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center bg-slate-50 p-6">
                    <div className="w-full max-w-md bg-white rounded-3xl shadow-2xl p-8 border border-slate-100 animate-fade">
                        <div className="text-center mb-8">
                            <h2 className="text-3xl font-bold text-slate-900">{type === 'login' ? t.login : t.register}</h2>
                            <p className="text-slate-500 mt-2">Q-TRACK Management System</p>
                        </div>
                        <form className="space-y-6" onSubmit={handleSubmit}>
                            <div>
                                <label className="block text-sm font-semibold text-slate-700 mb-2">{t.email}</label>
                                <input
                                    required
                                    type="email"
                                    placeholder="nom@entreprise.com"
                                    className="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-blue-500 outline-none transition-all focus-visible"
                                    value={formData.email}
                                    onChange={handleChange('email')}
                                />
                                {errors.email && <p className="text-red-500 text-sm mt-1">{errors.email}</p>}
                            </div>
                            <div>
                                <label className="block text-sm font-semibold text-slate-700 mb-2">{t.password}</label>
                                <input
                                    required
                                    type="password"
                                    placeholder="••••••••"
                                    className="w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-blue-500 outline-none transition-all focus-visible"
                                    value={formData.password}
                                    onChange={handleChange('password')}
                                />
                                {errors.password && <p className="text-red-500 text-sm mt-1">{errors.password}</p>}
                            </div>
                            {errors.general && <p className="text-red-500 text-sm text-center">{errors.general}</p>}
                            <button
                                type="submit"
                                disabled={isLoading}
                                className="w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold shadow-lg shadow-blue-500/30 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                {isLoading ? <LoadingSpinner size="sm" /> : (type === 'login' ? t.login : t.register)}
                            </button>
                        </form>
                        <div className="mt-8 text-center">
                            <button onClick={onToggle} className="text-blue-600 font-semibold hover:underline">
                                {type === 'login' ? t.no_account : t.have_account}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const Dashboard = ({nonConformites, t, isLoading}) => {
            // Mesure des statistiques (DMAIC - Measure)
            const stats = useMemo(() => {
                const total = nonConformites.length;
                const critical = nonConformites.filter(nc => nc.gravite === 'Critique').length;
                const major = nonConformites.filter(nc => nc.gravite === 'Majeure').length;
                const minor = nonConformites.filter(nc => nc.gravite === 'Mineure').length;

                return [
                    {icon: "fas fa-database", title: total, subtitle: "Non-Conformités", color: "blue"},
                    {icon: "fas fa-exclamation-triangle", title: critical, subtitle: "Critiques", color: "red"},
                    {icon: "fas fa-exclamation-circle", title: major, subtitle: "Majeures", color: "yellow"},
                    {icon: "fas fa-info-circle", title: minor, subtitle: "Mineures", color: "green"}
                ];
            }, [nonConformites]);

            return (
                <div className="space-y-8 animate-fade">
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        {stats.map((stat, index) => (
                            <StatCard
                                key={index}
                                icon={stat.icon}
                                value={stat.title}
                                subtitle={stat.subtitle}
                                color={stat.color}
                            />
                        ))}
                    </div>

                    {/* Tableau des NC (à implémenter) */}
                    <div className="bg-white rounded-3xl shadow-sm border border-slate-100 p-6">
                        <h3 className="text-xl font-bold text-slate-900 mb-4">Dernières Non-Conformités</h3>
                        {isLoading ? (
                            <div className="flex justify-center py-8">
                                <LoadingSpinner />
                            </div>
                        ) : (
                                <div className="overflow-x-auto">
                                    <table className="w-full">
                                        <thead>
                                            <tr className="border-b border-slate-200">
                                                <th className="text-left py-3 px-4 font-semibold text-slate-700">Type</th>
                                                <th className="text-left py-3 px-4 font-semibold text-slate-700">Poste</th>
                                                <th className="text-left py-3 px-4 font-semibold text-slate-700">Gravité</th>
                                                <th className="text-left py-3 px-4 font-semibold text-slate-700">Statut</th>
                                                <th className="text-left py-3 px-4 font-semibold text-slate-700">Date</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {nonConformites.slice(0, 5).map(nc => (
                                                <tr key={nc.id} className="border-b border-slate-100 hover:bg-slate-50">
                                                    <td className="py-3 px-4">{nc.type_defaut}</td>
                                                    <td className="py-3 px-4">{nc.poste}</td>
                                                    <td className="py-3 px-4">
                                                        <span className={`px-2 py-1 rounded-full text-xs font-semibold ${nc.gravite === 'Critique' ? 'bg-red-100 text-red-800' :
                                                                nc.gravite === 'Majeure' ? 'bg-yellow-100 text-yellow-800' :
                                                                    'bg-green-100 text-green-800'
                                                            }`}>
                                                            {nc.gravite}
                                                        </span>
                                                    </td>
                                                    <td className="py-3 px-4">{nc.statut}</td>
                                                    <td className="py-3 px-4">{new Date(nc.date_creation).toLocaleDateString()}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            )}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [view, setView] = useState('landing'); // landing, login, register, app
            const [lang, setLang] = useState(CONFIG.DEFAULT_LANG);
            const [user, setUser] = useState(null);
            const [selectedModule, setSelectedModule] = useState('dashboard');
            const [nonConformites, setNonConformites] = useState([]);
            const [notifications, setNotifications] = useState([]);
            const [isLoading, setIsLoading] = useState(false);
            const [showNotification, setShowNotification] = useState(false);
            const [notification, setNotification] = useState(null);

            const t = useMemo(() => translations[lang], [lang]);

            // Gestion des notifications (ISO 9001 - Communication)
            const addNotification = useCallback((type, message) => {
                const newNotification = {id: Date.now(), type, message};
                setNotifications(prev => [newNotification, ...prev]);
                setNotification(newNotification);
                setShowNotification(true);

                // Auto-suppression après 5 secondes
                setTimeout(() => {
                    setShowNotification(false);
                    setNotifications(prev => prev.filter(n => n.id !== newNotification.id));
                }, 5000);
            }, []);

            // Chargement des données (DMAIC - Measure)
            useEffect(() => {
                if (view === 'app' && !nonConformites.length) {
                    loadNonConformites();
                }
            }, [view, nonConformites.length]);

            const loadNonConformites = async () => {
                setIsLoading(true);
                try {
                    // Simulation de chargement de données
                    const response = await fetch(CONFIG.API_ENDPOINTS.NON_CONFORMITES);
                    if (!response.ok) throw new Error('Network response was not ok');

                    const data = await response.json();
                    setNonConformites(data);
                    Logger.info("Non-conformities loaded", {count: data.length});
                } catch (error) {
                    Logger.error("Failed to load non-conformities", error);
                    addNotification('error', t.network_error);
                } finally {
                    setIsLoading(false);
                }
            };

            const handleAuth = async (credentials) => {
                setIsLoading(true);
                try {
                    // Simulation d'authentification
                    const response = await fetch(CONFIG.API_ENDPOINTS.LOGIN, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify(credentials)
                    });

                    if (!response.ok) throw new Error('Authentication failed');

                    const userData = await response.json();
                    setUser(userData);
                    setView('app');
                    addNotification('success', t.email_sent);
                    Logger.info("User authenticated", userData);
                } catch (error) {
                    Logger.error("Authentication failed", error);
                    addNotification('error', t.network_error);
                } finally {
                    setIsLoading(false);
                }
            };

            // Cacher l'indicateur de chargement initial
            useEffect(() => {
                const timer = setTimeout(() => {
                    document.getElementById('loading-indicator').style.display = 'none';
                }, 1000);

                return () => clearTimeout(timer);
            }, []);

            const renderMainContent = () => {
                switch (selectedModule) {
                    case 'dashboard':
                        return <Dashboard nonConformites={nonConformites} t={t} isLoading={isLoading} />;
                    case 'operations':
                        return <div className="p-8"><h2>{t.nc_operations}</h2></div>;
                    case 'analysis':
                        return <div className="p-8"><h2>{t.analysis}</h2></div>;
                    case 'reports':
                        return <div className="p-8"><h2>{t.reports}</h2></div>;
                    case 'settings':
                        return <div className="p-8"><h2>{t.settings}</h2></div>;
                    default:
                        return <Dashboard nonConformites={nonConformites} t={t} isLoading={isLoading} />;
                }
            };

            if (view === 'landing') return <LandingPage onLogin={() => setView('login')} onRegister={() => setView('register')} t={t} isLoading={isLoading} />;
            if (view === 'login') return <AuthForm type="login" onSubmit={handleAuth} onToggle={() => setView('register')} t={t} isLoading={isLoading} />;
            if (view === 'register') return <AuthForm type="register" onSubmit={handleAuth} onToggle={() => setView('login')} t={t} isLoading={isLoading} />;

            return (
                <div className="flex h-screen bg-slate-50 overflow-hidden">
                    {/* Sidebar */}
                    <aside className="w-72 bg-slate-900 text-white flex flex-col p-6 shadow-2xl z-50 sidebar-transition">
                        <div className="mb-12 flex items-center space-x-3">
                            <div className="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center">
                                <i className="fas fa-q text-xl font-black"></i>
                            </div>
                            <h1 className="text-2xl font-black tracking-tighter">Q-TRACK</h1>
                        </div>

                        <nav className="flex-1 space-y-2">
                            {[
                                {id: 'dashboard', icon: 'fa-chart-pie', label: t.dashboard},
                                {id: 'operations', icon: 'fa-clipboard-list', label: t.nc_operations},
                                {id: 'analysis', icon: 'fa-microscope', label: t.analysis},
                                {id: 'reports', icon: 'fa-file-shield', label: t.reports},
                                {id: 'settings', icon: 'fa-gear', label: t.settings}
                            ].map(item => (
                                <button
                                    key={item.id}
                                    onClick={() => setSelectedModule(item.id)}
                                    className={`w-full flex items-center px-4 py-3 rounded-2xl transition-all sidebar-transition ${selectedModule === item.id ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/20' : 'text-slate-400 hover:bg-white/5 hover:text-white'}`}
                                >
                                    <i className={`fas ${item.icon} w-6 text-lg mr-3`}></i>
                                    <span className="font-bold text-sm tracking-wide">{item.label}</span>
                                </button>
                            ))}
                        </nav>

                        <div className="pt-6 border-t border-slate-800 space-y-4">
                            <button
                                onClick={() => setLang(lang === 'fr' ? 'en' : 'fr')}
                                className="w-full flex items-center px-4 py-2 text-slate-400 hover:text-white text-sm font-bold"
                            >
                                <i className="fas fa-globe mr-3"></i> {lang === 'fr' ? 'ENGLISH' : 'FRANÇAIS'}
                            </button>
                            <button
                                onClick={() => {
                                    setUser(null);
                                    setView('landing');
                                    addNotification('info', t.logout);
                                }}
                                className="w-full flex items-center px-4 py-3 rounded-2xl bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white transition-all sidebar-transition"
                            >
                                <i className="fas fa-power-off w-6 mr-3"></i>
                                <span className="font-bold text-sm uppercase tracking-widest">{t.logout}</span>
                            </button>
                        </div>
                    </aside>

                    {/* Main Content */}
                    <main className="flex-1 flex flex-col overflow-hidden relative">
                        <header className="h-24 glass border-b border-slate-200 flex items-center justify-between px-12 z-40">
                            <div>
                                <h2 className="text-2xl font-black text-slate-900 tracking-tight capitalize">{selectedModule}</h2>
                                <p className="text-sm text-slate-500 font-medium">Connecté en tant que: <span className="text-blue-600">{user?.email}</span></p>
                            </div>
                            <div className="flex items-center space-x-6">
                                <div className="relative group cursor-pointer">
                                    <div className="p-3 bg-white rounded-2xl shadow-sm border border-slate-100 text-slate-400 hover:text-blue-600 transition-all focus-visible">
                                        <i className="fas fa-bell text-xl"></i>
                                        {notifications.length > 0 && (
                                            <span className="absolute top-2 right-2 w-3 h-3 bg-red-500 rounded-full border-2 border-white"></span>
                                        )}
                                    </div>
                                    {/* Notifications Dropdown logic here */}
                                </div>
                                <div className="w-14 h-14 bg-gradient-to-tr from-blue-600 to-blue-400 rounded-2xl shadow-lg flex items-center justify-center text-white text-xl font-black">
                                    {user?.email?.[0].toUpperCase()}
                                </div>
                            </div>
                        </header>

                        <div className="flex-1 overflow-y-auto p-12">
                            {renderMainContent()}

                            <div className="mt-12 p-8 bg-blue-600 rounded-[3rem] text-white flex items-center justify-between shadow-2xl shadow-blue-500/20">
                                <div className="space-y-2">
                                    <h3 className="text-3xl font-black">Besoin d'aide ?</h3>
                                    <p className="text-blue-100">Consultez la documentation complète de Q-TRACK.</p>
                                </div>
                                <button className="px-8 py-4 bg-white text-blue-600 rounded-2xl font-bold shadow-xl hover:scale-105 transition-all focus-visible">
                                    Voir les tutoriels
                                </button>
                            </div>
                        </div>
                    </main>
                </div>
            );
        };

        // Initialisation de l'application (PDCA - Plan)
        const initApp = () => {
            Logger.info("Q-TRACK application initializing", {
                version: CONFIG.APP_VERSION,
                language: CONFIG.DEFAULT_LANG,
                timestamp: new Date().toISOString()
            });

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<App />);
        };

        // Démarrage de l'application
        initApp();
    </script>
</body>

</html>